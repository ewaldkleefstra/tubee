<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Getting started - tubee</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Getting started";
    var mkdocs_page_input_path = "10-deploy-server.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> tubee</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">About tubee</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../02-getting-started/">Getting started</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../03-namespaces/">Namespaces</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Getting started</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#getting-started">Getting started</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#debian-based-distribution">Debian based distribution</a></li>
        
            <li><a class="toctree-l3" href="#docker-docker-compose">Docker (docker-compose)</a></li>
        
            <li><a class="toctree-l3" href="#deploy-on-kubernetes">Deploy on kubernetes</a></li>
        
            <li><a class="toctree-l3" href="#using-the-tar-archive">Using the tar archive</a></li>
        
            <li><a class="toctree-l3" href="#manually-install-from-source">Manually install from source</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">tubee</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Getting started</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="getting-started">Getting started</h1>
<p>This is a step-by-step tutorial how to correctly deploy the tubee server.</p>
<p>There are multiple supported ways to deploy tubee:</p>
<ul>
<li>Classic way as deb package via apt</li>
<li>Manually as tar archive</li>
<li>Docker (docker-compose or via a orchestration plattform like <a href="https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/">Kubernetes</a>)</li>
<li>Compile manually from scratch</li>
</ul>
<p>The docker deployment is the <strong>recommended</strong> way to deploy tubee. And it is also the simplest way.</p>
<h2 id="debian-based-distribution">Debian based distribution</h2>
<p>Both the server and the web ui get distributed as .deb packages to make it easy to install and upgrade.</p>
<p><strong>Requirements</strong>:
* Debian based linux distribution</p>
<p>You need a running debian based linux distribution. This can be <a href="https://www.debian.org">debian</a> itself or debian based distribution like <a href="https://www.ubuntu.com">Ubuntu</a>. You may also convert the package using <code>alien</code> to rpm and other package formats. 
If you are not sure how to deploy such a server please visit the documentation of those distributions as this is out of the scope of this documentation.</p>
<p>This tutorial describes how to install all tubee components on the same server. In production environments this may not be the best way and it is neither scalable nor performant. You certainly can deploy all components on different server. The tubee server is fully scalable and can be scaled horizontally as well as can the required components like MongoDB. Everything is easlily scaleable to your needs.</p>
<h3 id="package-repository">Package Repository</h3>
<p>You need to add the tubee repository to your package management configuration as well as repositories for the latest PHP and MongoDB releases.
The following commands must be executed with <code>root</code> permissions unless noted otherwise.</p>
<h4 id="tubee">tubee</h4>
<pre><code class="sh">apt-get -y install apt-transport-https
echo &quot;deb https://dl.bintray.com/gyselroth/tubee stable main&quot; | sudo tee -a /etc/apt/sources.list
wget -qO - https://bintray.com/user/downloadSubjectPublicKey?username=gyselroth | sudo apt-key add -
sudo apt-get update
</code></pre>

<blockquote>
<p><strong>Note</strong>: If you want to install beta and alpha versions replace <code>stable</code> with <code>unstable</code>. Pre-releases are only ment for testing purposes and are in <strong>no</strong> way recommended in production environements!</p>
<p><strong>Note</strong>: This repository also includes the shell client <code>tubectl</code>.</p>
</blockquote>
<h4 id="php">PHP</h4>
<p>The tubee server requires PHP 7.2. If your current distribution does not provide 7.2 out of their stable archives (which is most certainly the case) please add the PPA ppa:ondrej/php which will provide the latest PHP 7.2 releases.</p>
<pre><code class="sh">sudo apt-get install lsb-release ca-certificates
sudo wget -O /etc/apt/trusted.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg
echo &quot;deb https://packages.sury.org/php/ $(lsb_release -sc) main&quot; | sudo tee /etc/apt/sources.list.d/php.list
sudo apt-get update
</code></pre>

<h4 id="mongodb">MongoDB</h4>
<p>tubee uses MongoDB as its main database. At least MongoDB 3.4 is required. If your current distribution does not ship at least this release you will need to add the official MongoDB repository.</p>
<blockquote>
<p><strong>Note</strong>: MongoDB recommends to use the official MongoDB repository anyway since the releases in the debian and or ubuntu repositories are not maintained by them and lack newer minor releases.</p>
</blockquote>
<pre><code class="sh">sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 2930ADAE8CAF5059EE73BB4B58712A2291FA4AD5
echo &quot;deb http://repo.mongodb.org/apt/debian jessie/mongodb-org/3.6 main&quot; | sudo tee /etc/apt/sources.list.d/mongodb-org-3.6.list
sudo apt-get update
</code></pre>

<blockquote>
<p><strong>Note</strong>: This will add the repository for debian jessie, if you need another repository please refer to the <a href="https://docs.mongodb.com/manual/administration/install-on-linux/">MongoDB installation</a> docs.</p>
</blockquote>
<h3 id="install-tubee">Install tubee</h3>
<p>Now tubee and its components can be installed.</p>
<pre><code>apt-get install mongodb-org tubee
</code></pre>

<h2 id="docker-docker-compose">Docker (docker-compose)</h2>
<p>The easiest, fastest and recommended way to deploy a tubee environment is to spin it up using docker and docker-compose.
Since the installation is not the same for different host os and docker can be started on Linux, Windows and Mac please visit 
the docker documentation on how to install <a href="https://docs.docker.com/install">docker</a> and <a href="https://docs.docker.com/compose/install">docker-compose</a>.</p>
<p>Now a docker-compose file is required with all required containers by tubee.
Create a file named <code>tubee-stable.yaml</code> with this content:</p>
<p><strong>Requirements</strong>:
<em> docker
</em> docker-compose</p>
<pre><code class="yaml">mongodb:
    image: mongo:3.6.0
postfix:
    image: webuni/postfix
tubee:
    image: gyselroth/tubee:latest
    links:
        - clamav
        - mongodb
        - elasticsearch
        - postfix
        - browserless
    entrypoint: php-fpm
    environment:
        - BALLOON_MONGODB_URI=mongodb://mongodb:27017
        - BALLOON_CLAMAV_URI=tcp://clamav:3310
        - BALLOON_ELASTICSEARCH_URI=http://elasticsearch:9200
        - BALLOON_WOPI_URL=https://tubee
        - BALLOON_SMTP_HOST=postfix
        - BALLOON_URL=http://localhost:8080
        - BALLOON_BURL_BROWSERLESS_URL=http://browserless:3000
tubee-jobs:
    image: gyselroth/tubee:latest
    links:
        - clamav
        - mongodb
        - elasticsearch
        - postfix
        - browserless
    entrypoint: tubeecli jobs
    environment:
        - BALLOON_MONGODB_URI=mongodb://mongodb:27017
        - BALLOON_CLAMAV_URI=tcp://clamav:3310
        - BALLOON_ELASTICSEARCH_URI=http://elasticsearch:9200
        - BALLOON_WOPI_URL=https://tubee
        - BALLOON_SMTP_HOST=postfix
        - BALLOON_URL=http://localhost:8080
        - BALLOON_BURL_BROWSERLESS_URL=http://browserless:3000
</code></pre>

<p>The tubee server can now be started using:</p>
<pre><code>docker-compose -f tubee-stable.yaml up
</code></pre>

<p>You need to initialize tubee once (You do not need to execute this everytime you start the server via docker-compose, it is just a one time call):</p>
<pre><code>docker exec tubee-stable-tubee_1 tubeecli upgrade -i -vvv
</code></pre>

<blockquote>
<p><strong>Note</strong>: All tubee containers provide a version tag besides <code>latest</code>. It is best practice to use an exact version of a service instead the latest tag in production environment.
The containers provide a <code>latest-unstable</code> tag for the tubee-jobs, tubee and tubee-web container. It is in no way reccomened to use pre-releases in production environments! </p>
<p><strong>Note</strong>: If you want to install beta and alpha versions replace <code>latest</code> with <code>latest-unstable</code> or specify an exact version tag. Pre-releases are only ment for testing purposes and are in <strong>no</strong> way recommended in production environements!</p>
</blockquote>
<h2 id="deploy-on-kubernetes">Deploy on kubernetes</h2>
<h2 id="using-the-tar-archive">Using the tar archive</h2>
<p>Instead a deb package you may also use a tar archive and install tubee manually on your system. 
A tar archive is an already builded relase, you you just need to have all requirements installed on your system, you may have a look at <a href="#manually-install-from-source">Manually install from source</a>.</p>
<h2 id="manually-install-from-source">Manually install from source</h2>
<p>This topic is only for advanced users or developers and describes how to deploy tubee by installing from source.
If you are a developer please also continue reading <a href="https://github.com/gyselroth/tubee/blob/master/CONTRIBUTING.md">this</a> article.</p>
<p><strong>Requirements</strong>:
<em> posix based operating system (Basically every linux/unix)
</em> make
<em> <a href="https://getcomposer.org/download/">comoser</a>
</em> git
<em> php &gt;= 7.2
</em> php ext-mongodb
<em> php ext-curl
</em> php ext-mbstring
<em> php ext-posix
</em> php ext-pnctl
* php ext-apcu</p>
<p><strong>Optional requirements</strong>:</p>
<ul>
<li>php ext-imagick (If you want to use The ImageEndpoint)</li>
<li>php ext-ldap (If you want to use LDAP authentication and/or the LdapEndpoint)</li>
<li>php ext-smb (If you want to use the SmbStorage)</li>
<li>php ext-xml (If you want to use the XmlEndpoint)</li>
<li>php ext-pdo (If you want to use the PdoEndpoint)</li>
<li>php ext-mysql (If you want ot use the MysqlEndpoint)</li>
</ul>
<p>This will only install the tubee server. Dependencies such as MongoDB do not get installed.
You can install those dependencies either by using distributed packages, see <a href="#debian-based-distribution">Debian based distribution</a> or by installing them seperately from source.</p>
<h3 id="install-tubee-server">Install tubee server</h3>
<pre><code class="sh">git clone https://github.com/gyselroth/tubee.git
cd tubee
make install
</code></pre>

<blockquote>
<p><strong>Note</strong>: You can also create .deb or .tar packages using make. Just execute either <code>make deb</code> or <code>make tar</code> or <code>make dist</code> for both.</p>
</blockquote>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../03-namespaces/" class="btn btn-neutral" title="Namespaces"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../03-namespaces/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
